# Flask Application - Apache2 Configuration
# This is a sample Apache2 virtual host configuration for the Flask application
# with reverse proxy using mod_proxy

# Install required Apache modules:
# sudo a2enmod proxy
# sudo a2enmod proxy_http
# sudo a2enmod rewrite
# sudo a2enmod headers

<VirtualHost *:80>
    ServerName localhost
    ServerAlias localhost
    
    # Log files
    ErrorLog ${APACHE_LOG_DIR}/flask_app_error.log
    CustomLog ${APACHE_LOG_DIR}/flask_app_access.log combined
    
    # Proxy settings - forward requests to the Flask development server
    ProxyPreserveHost On
    ProxyPass / http://127.0.0.1:5000/
    ProxyPassReverse / http://127.0.0.1:5000/
    
    # Optional: Set proxy timeout for long-running requests
    ProxyTimeout 300
    
    # Optional: Add headers for proxied requests
    RequestHeader set X-Forwarded-For "%{REMOTE_ADDR}s"
    RequestHeader set X-Forwarded-Proto "http"
    RequestHeader set X-Forwarded-Host "%{SERVER_NAME}s"
    
    # Optional: Enable mod_wsgi for direct deployment (alternative to reverse proxy)
    # Uncomment the following lines and install mod_wsgi for direct deployment
    # WSGIDaemonProcess flask_app user=www-data group=www-data threads=5
    # WSGIScriptAlias / /path/to/flask_app/wsgi.py
    # WSGIProcessGroup flask_app
    # WSGIApplicationGroup %{GLOBAL}
    
    # Static files (optional - only if not serving through Flask)
    # Alias /static /path/to/flask_app/app/static
    # <Directory /path/to/flask_app/app/static>
    #     Require all granted
    # </Directory>

</VirtualHost>

# Enable SSL/HTTPS (Optional)
# Install certbot: sudo apt-get install certbot python3-certbot-apache
# Run: sudo certbot --apache -d your-domain.com

# <VirtualHost *:443>
#     ServerName your-domain.com
#     ServerAlias www.your-domain.com
#     
#     SSLEngine on
#     SSLCertificateFile /etc/letsencrypt/live/your-domain.com/fullchain.pem
#     SSLCertificateKeyFile /etc/letsencrypt/live/your-domain.com/privkey.pem
#     
#     ProxyPreserveHost On
#     ProxyPass / http://127.0.0.1:5000/
#     ProxyPassReverse / http://127.0.0.1:5000/
#     
#     ErrorLog ${APACHE_LOG_DIR}/flask_app_ssl_error.log
#     CustomLog ${APACHE_LOG_DIR}/flask_app_ssl_access.log combined
# </VirtualHost>
